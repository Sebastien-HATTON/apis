(function(t,e,r,o){function n(o){if(!r[o]){if(!e[o]){if(t)return t(o);throw Error("Cannot find module '"+o+"'")}var s=r[o]={exports:{}};e[o][0](function(t){var r=e[o][1][t];return n(r?r:t)},s,s.exports)}return r[o].exports}for(var s=0;o.length>s;s++)n(o[s]);return n})("undefined"!=typeof require&&require,{1:[function(t,e,r){"use strict";var o=t("../../lib/client"),n="apis"in window,s=window.apis;window.apis=o,o.noConflict=function(){return n?window.apis=s:delete window.apis,o}},{"../../lib/client":2}],2:[function(t,e,r){"use strict";var o=t("./errors"),n=t("./http"),s=t("./http_request"),a=t("./jsonp_request"),i=t("./socket");e.exports={errors:o,Http:n,HttpRequest:s,JsonpRequest:a,Socket:i}},{"./errors":3,"./http":4,"./http_request":5,"./jsonp_request":6,"./socket":7}],4:[function(t,e,r){"use strict";var o=t("../node_client/http_adapter"),n=t("./http_request"),s=t("./jsonp_request"),a=t("./errors"),i=function(t,e){this.baseUri=t,this.options=e||{},this.adapter=null};i.prototype.setAdapter=function(t){this.adapter=t},i.prototype.send=function(t,e,r,o,n,s){this.ensureAdapter();var a;if(null==n||null==n.crossDomain)a=this.sendHttp(t,e,r,o,n,s);else switch(n.crossDomain){case"jsonp":a=this.sendJsonp(t,e,r,o,n,s);break;default:throw Error("Unsupported crossDomain option "+n.crossDomain)}return a},i.prototype.ensureAdapter=function(){null==this.adapter&&(this.adapter=this.createAdapter(this.options.adapter))},i.prototype.createAdapter=function(t){return new o(t)},i.prototype.sendHttp=function(t,e,r,o,s,a){var i=this.adapter.createRequestData(this.baseUri,t,e,r,o,s),c=this;return n.send(i,s,function(t,e){c.handleHttpResult(t,e,s,a)})},i.prototype.sendJsonp=function(t,e,r,o,n,a){var i=this.adapter.createRequestUrl(this.baseUri,t,e,r,o,n),c=this;return s.send(i,n,function(t,e){c.handleJsonpResult(t,e,n,a)})},i.prototype.handleHttpResult=function(t,e,r,o){var n;null==t&&(n=this.adapter.parseResponseData(e.status,e.headers,e.body,r),t=this.extractError(n)),o(t,n)},i.prototype.handleJsonpResult=function(t,e,r,o){null==t&&(t=this.extractError(e)),o(t,e)},i.prototype.extractError=function(t){var e=t.status,r=null;return 200!=e&&204!=e&&(r=new a.WebError(t)),r},e.exports=i},{"../node_client/http_adapter":8,"./http_request":5,"./jsonp_request":6,"./errors":3}],5:[function(t,e,r){"use strict";var o=t("./errors").NetworkError,n=function(t){this.isAborted=!1,this.xhr=null,this.cb=null};n.prototype.send=function(t,e){this.cb=e;var r=new XMLHttpRequest;this.xhr=r;var o=this;r.onreadystatechange=function(){4==r.readyState&&(r.onreadystatechange=null,o.isAborted||o.handleResult())},r.open(t.method,t.url);for(var n in t.headers)r.setRequestHeader(n,t.headers[n]);r.send(t.body)},n.prototype.abort=function(){this.isAborted=!0,this.xhr.onreadystatechange=null,this.xhr.abort()},n.prototype.handleResult=function(){var t=this.xhr;t.status?this.cb(null,{status:t.status,headers:{get:function(e){return t.getResponseHeader(e)}},body:t.responseText}):this.cb(new o)},n.send=function(t,e,r){var o=new n(e);return o.send(t,r),o},e.exports=n},{"./errors":3}],6:[function(t,e,r){"use strict";var o=t("./errors").NetworkError,n=function(t){var e=t||{};this.callbackUrlKey=e.callbackUrlKey||this.defaultCallbackUrlKey,this.callbacks=this.getCallbacks(),this.cb=null,this.scriptEl=null,this.callbackId=null};n.prototype.callbacksGlobalPath="apis.jsonp.callbacks",n.prototype.defaultCallbackUrlKey="callback",n.prototype.getCallbacks=function(){if(null==n.callbacks){for(var t=this.callbacksGlobalPath.split("."),e=window,r=0;t.length>r;r++){var o=t[r],s=e[o]||{};e[o]=s,e=s}n.callbacks=e}return n.callbacks},n.prototype.send=function(t,e){this.cb=e,this.initCallback(),t=this.addCallbackToUrl(t),this.injectScript(t)},n.prototype.initCallback=function(){var t=this;this.callbackId=this.createCallbackId(),this.callbacks[this.callbackId]=function(e){t.isAborted||(t.cleanup(),t.handleResult(e))}},n.prototype.createCallbackId=function(){for(var t="cb"+(new Date).getTime(),e=0,r=t;r in this.callbacks;)r=t+"_"+e++;return r},n.prototype.addCallbackToUrl=function(t){var e=t.indexOf("?"),r;return r=0>e?[t,"?",this.callbackUrlKey,"=",this.createCallbackName()].join(""):[t.substr(0,e+1),this.callbackUrlKey,"=",this.createCallbackName(),"&",t.substr(e+1)].join("")},n.prototype.createCallbackName=function(){return[this.callbacksGlobalPath,".",this.callbackId].join("")},n.prototype.createScript=function(){var t=document.createElement("script");t.async=!0;var e=this;return t.onerror=function(t){e.handleScriptErrorEvent(t)},t},n.prototype.injectScript=function(t){var e=this.createScript();this.scriptEl=e;var r=document.head||document.getElementsByTagName("head")[0]||document.documentElement,o=r.firstChild;o?r.insertBefore(e,r.firstChild):r.appendChild(e),e.src=t},n.prototype.handleScriptErrorEvent=function(t){this.isAborted||(this.cleanup(),this.cb(new o))},n.prototype.abort=function(){this.isAborted=!0,this.cleanup()},n.prototype.cleanup=function(){this.removeCallback(),this.removeScripEl()},n.prototype.removeCallback=function(){delete this.callbacks[this.callbackId]},n.prototype.removeScripEl=function(){var t=this.scriptEl;null!=t&&t.parentNode&&(t.parentNode.removeChild(t),this.scriptEl=null)},n.prototype.handleResult=function(t){var e=t.headers||{};t.headers=e,t.status=e.status,this.cb(null,t)},n.send=function(t,e,r){var o=new n(e);return o.send(t,r),o},e.exports=n},{"./errors":3}],7:[function(t,e,r){"use strict";var o=t("./errors"),n=function(t,e,r){this.basePath=t,this.socketUri=e||this.defaultSocketUri,this.protocols=r,this.onSocketCreated=null,this.onMessage=null,this.webSocketClass=WebSocket,this.socket=null,this.requests={},this.abortFunc=this.createAbortFunc()};n.prototype.defaultSocketUri="/socket",n.prototype.headerSeparator="\n\n",n.prototype.defaultTimeout=null,n.prototype.setWebSocketClass=function(t){this.webSocketClass=t},n.prototype.createAbortFunc=function(){var t=this;return function(){t.handleAbort(this)}},n.prototype.createSocket=function(){var t=this.webSocketClass;return new t(this.socketUri,this.protocols)},n.prototype.connect=function(t){if(null!=this.socket)switch(this.socket.readyState){case 0:t&&this.socket.addEventListener("open",function(){t()});break;case 1:t&&t();break;default:this.socket=null}if(null==this.socket){this.socket=this.createSocket(),this.onSocketCreated&&this.onSocketCreated(this.socket),t&&this.socket.addEventListener("open",function(){t()});var e=this;this.socket.addEventListener("message",function(t){e.handleMessage(t)}),this.socket.addEventListener("close",function(t){e.handleClose(t)})}},n.prototype.handleMessage=function(t){var e=this.parse(t.data),r=null!=e.headers?e.headers.requestId:null;if(null!=r){var o=this.requests[r];if(o){var n=o.cb;this.clearRequest(o,r);var s=this.extractError(e);null!=s?n(s):n(null,e)}}else null!=this.onMessage&&this.onMessage(e)},n.prototype.createRequestId=function(){for(var t=""+(new Date).getTime(),e=0,r=t;r in this.requests;)r=t+"_"+e++;return r},n.prototype.clearRequest=function(t){delete this.requests[t.id];var e=t.timeout;null!=e&&clearTimeout(e)},n.prototype.close=function(){null!=this.socket&&this.socket.close()},n.prototype.send=function(t,e,r,o,n,s){var a=this;this.connect(function(){a.sendInternal(t,e,r,o,n,s)})},n.prototype.sendInternal=function(t,e,r,o,n,s){r=r||{},r.method=e,r.path=this.getEffectivePath(t);var a;s&&(a=this.createRequest(n,s),r.requestId=a.id);var i;i=void 0===o?"":JSON.stringify(o);var c=[JSON.stringify(r),i].join(this.headerSeparator);return this.socket.send(c),a},n.prototype.getEffectivePath=function(t){var e=t;return this.basePath&&(e=this.basePath+t),e},n.prototype.createRequest=function(t,e){var r=this.createRequestId(),o={id:r,cb:e,options:t,abort:this.abortFunc};return o.timeout=this.createTimeout(o),this.requests[r]=o,o},n.prototype.createTimeout=function(t){var e=t.options,r=null,o=null!=e&&null!=e.timeout?e.timeout:this.defaultTimeout;if(null!=o){var n=this;r=setTimeout(function(){n.handleTimeout(t)},o)}return r},n.prototype.handleTimeout=function(t){var e=t.cb;this.clearRequest(t),e(new o.TimeoutError)},n.prototype.handleAbort=function(t){this.clearRequest(t)},n.prototype.handleClose=function(t){for(var e in this.requests){var r=this.requests[e],n=r.cb;this.clearRequest(r),n(new o.ConnectionCloseError(t))}},n.prototype.parse=function(t){var e=t.indexOf(this.headerSeparator),r=t.substring(0,e),o=t.substring(e+this.headerSeparator.length),n=JSON.parse(r),s={headers:n,data:this.parseBody(o)};return null!=n.status&&(s.status=n.status),s},n.prototype.parseBody=function(t){var e;return t&&(e=JSON.parse(t)),e},n.prototype.extractError=function(t){var e=t.status,r=null;return 200!=e&&204!=e&&(r=new o.WebError(t)),r},e.exports=n},{"./errors":3}],3:[function(t,e,r){"use strict";var o=t("inh"),n=t("nerr/lib/error_base"),s=function(t){n.call(this),this.response=t,this.status=t.status;var e=t.data||{};this._message=e.message,this.status=t.status,this.code=e.code};o(s,n),s.prototype.name="WebError",s.prototype.getMessage=function(){return this._message};var a=function(){n.call(this)};o(a,n),a.prototype.name="NetworkError";var i=function(){n.call(this)};o(i,n),i.prototype.name="TimeoutError";var c=function(t){n.call(this),this.closeEvent=t};o(c,n),c.prototype.name="ConnectionCloseError",c.prototype.getMessage=function(){return this.closeEvent.reason},e.exports={WebError:s,NetworkError:a,TimeoutError:i,ConnectionCloseError:c}},{"nerr/lib/error_base":9,inh:10}],10:[function(t,e,r){"use strict";var o;o="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t},e.exports=o},{}],8:[function(t,e,r){"use strict";var o=t("ops"),n=function(t){this.options=o.cloneWithDefaults(t,this.getDefaultOptions())};n.prototype.getDefaultOptions=function(){return{transform:{headers:{req:{method:"X-Method",contentType:"Content-type",auth:{token:"X-Auth",expected:"X-AuthExpected"}},res:{renewal:{token:"X-AuthRenewal",issued:"X-AuthRenewalIssued",maxAge:"X-AuthRenewalMaxAge"}}},url:{headers:"headers",body:"body"}},defaultContentType:"application/json"}},n.prototype.createRequestData=function(t,e,r,o,n,s){var a=this.createMethod(r,s),i=this.createBody(n,s),c=i&&this.canHaveBody(a,s),u=this.createHeaders(r,o,c,s),p=null;!c&&i&&(p={body:i});var l=this.createUrl(t,e,p,s);return{url:l,method:a,headers:u,body:i,options:s.http}},n.prototype.createRequestUrl=function(t,e,r,o,n,s){return"get"!=r&&(o=o||{},o.method=r),this.createUrl(t,e,{headers:this.stringifyHeaders(o,s),body:this.createBody(n,s)},s)},n.prototype.parseResponseData=function(t,e,r,o){return e.constructor===Object&&(e={get:function(t){return e[t]}}),{status:t,headers:this.parseHeaders(e,o),data:this.parseBody(r,o)}},n.prototype.canHaveBody=function(t,e){return"GET"!=t&&"HEAD"!=t},n.prototype.createUrl=function(t,e,r,o){var n=[t,e];if(null!=r){var s=this.createQuery(r,o);s&&n.push("?",s)}return n.join("")},n.prototype.createMethod=function(t,e){return{get:"GET",head:"HEAD",options:"OPTIONS"}[t]||"POST"},n.prototype.createQuery=function(t,e){var r=[],o=this.options.transform.url;for(var n in t){var s=t[n];if(s){var a=o[n];a&&r.push(this.createQueryItem(o[n],s))}}return r.length>0?r.join("&"):null},n.prototype.createQueryItem=function(t,e){return[t,encodeURIComponent(e)].join("=")},n.prototype.createHeaders=function(t,e,r,o){e=e||{};var n={};if(e.http)for(var s in e.http)n[s]=e.http[s];var a=this.options.transform.headers.req;return"get"!=t&&"head"!=t&&"create"!=t&&"options"!=t&&(n[a.method]=t),this.applyHeaders(a,n,e,o),r&&!e[a.contentType]&&(n[a.contentType]=this.options.defaultContentType),n},n.prototype.applyHeaders=function(t,e,r,o){r.contentType&&(e[t.contentType]=r.contentType),null!=r.auth&&this.applyAuthHeaders(t.auth,e,r.auth,o)},n.prototype.applyAuthHeaders=function(t,e,r,o){r.token&&(e[t.token]=r.token,r.expected&&(e[t.expected]=r.expected))},n.prototype.stringifyHeaders=function(t,e){var r=null;if(null!=t){var o=t.http;o&&delete t.http,r=JSON.stringify(t),o&&(t.http=o)}return r},n.prototype.createBody=function(t,e){var r;return void 0!==t&&(r=JSON.stringify(t)),r},n.prototype.parseHeaders=function(t,e){var r={},o=this.options.transform.headers.res,n=this.parseRenewalHeaders(o.renewal,t,e);return n&&(r.renewal=n),r},n.prototype.parseRenewalHeaders=function(t,e,r){var o=null,n=e.get(t.token);if(n){o={token:n};var s=parseInt(e.get(t.issued),10);isNaN(s)||(o.issued=s);var a=parseInt(e.get(t.maxAge),10);isNaN(a)||(o.maxAge=a)}return o},n.prototype.parseBody=function(t){return t?JSON.parse(t):void 0},e.exports=n},{ops:11}],11:[function(t,e,r){"use strict";var o=function(){};o.prototype.isDict=function(t){return null!=t&&t.constructor===Object},o.prototype.defines=function(t,e){return void 0!==t[e]},o.prototype.applyDefaults=function(t,e,r){var o;if(null==t)r&&(e=this.clone(e)),o=e;else if(o=t,null!=e)for(var n in e){var s=e[n];if(this.defines(t,n)){if(this.isDict(s)){var a=t[n];this.isDict(a)&&this.applyDefaults(a,s)}}else r&&(s=this.clone(s)),t[n]=s}return o},o.prototype.clone=function(t){return this.cloneValueWithDefaults(t)},o.prototype.cloneWithDefaults=function(t,e,r){var o;return o=null==t?r?this.clone(e):e:this.cloneValueWithDefaults(t,e,r)},o.prototype.cloneValueWithDefaults=function(t,e,r){return null!=t&&(this.isDict(t)?t=this.cloneDictWithDefaults(t,e,r):Array.isArray(t)&&(t=this.cloneArray(t))),t},o.prototype.cloneDict=function(t){return this.cloneDictWithDefaults(t)},o.prototype.cloneDictWithDefaults=function(t,e,r){var o={},n;this.isDict(e)||(e=null);for(n in t){var s;null!=e&&n in e&&(s=e[n]),o[n]=this.cloneValueWithDefaults(t[n],s,r)}if(null!=e)for(n in e)this.defines(t,n)||(o[n]=r?this.clone(e[n]):e[n]);return o},o.prototype.cloneArray=function(t){for(var e=[],r=0;t.length>r;r++)e.push(this.clone(t[r]));return e};var n=new o;n.Ops=o;var s={applyDefaults:function(t,e,r){return n.applyDefaults(t,e,r)},cloneWithDefaults:function(t,e,r){return n.cloneWithDefaults(t,e,r)},clone:function(t){return n.clone(t)}};e.exports=s},{}],9:[function(t,e,r){"use strict";var o=t("inh"),n=function(){Error.call(this),this.captureStackTrace()};o(n,Error),n.prototype.name="ErrorBase",n.prototype.captureStackTrace=function(){if(Error.captureStackTrace)Error.captureStackTrace(this,this.constructor);else{var t=Error(),e=this;t.toString=function(){return""+e};var r=function(){return t.stack};Object.defineProperties?Object.defineProperties({stack:r}):this.getStackTrace=r}},n.prototype.toString=function(){var t=this.name,e=this.getMessage();return e&&(t=[t,e].join(": ")),t},n.prototype.getMessage=function(){return null},n.prototype.getStackTrace=function(){return this.stack},Object.defineProperties&&Object.defineProperties(n.prototype,{message:{get:function(){return this.getMessage()}}}),e.exports=n},{inh:12}],12:[function(t,e,r){"use strict";var o;o="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t},e.exports=o},{}]},{},[1]);